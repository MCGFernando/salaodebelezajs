<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/mystyle.css" />
    <title>Document</title>
  </head>
  <body>
    <table
      id="table"
      data-toggle="table"
      data-search="true"
      data-filter-control="true"
      data-show-export="true"
      data-click-to-select="true"
      data-toolbar="#toolbar"
    >
      <thead>
        <tr>
          <th data-field="state" data-checkbox="true"></th>
          <th
            data-field="prenom"
            data-filter-control="input"
            data-sortable="true"
          >
            Prénom
          </th>
          <th
            data-field="prenom"
            data-filter-control="input"
            data-sortable="true"
          >
            Prénom
          </th>
          <th
            data-field="prenom"
            data-filter-control="input"
            data-sortable="true"
          >
            Prénom
          </th>
          <th
            data-field="prenom"
            data-filter-control="input"
            data-sortable="true"
          >
            Prénom
          </th>
          <th
            data-field="date"
            data-filter-control="select"
            data-sortable="true"
          >
            Date
          </th>
          <th
            data-field="examen"
            data-filter-control="select"
            data-sortable="true"
          >
            Examen
          </th>
          <th data-field="note" data-sortable="true">Note</th>
          <th data-field="note" data-sortable="true">Acção</th>
        </tr>
      </thead>
      <tbody>
        <% if (staffs.length > 0){%> <% staffs.forEach(staff=>{ %>
        <tr>
          <td class="bs-checkbox">
            <input data-index="0" name="btSelectItem" type="checkbox" />
          </td>
          <td><%= staff.conta.nome%></td>
          <td><%= staff.conta.email%></td>
          <td><%= staff.conta.telefone%></td>
          <td><%= staff.bi%></td>
          <td><%= staff.genero%></td>
          <td><%= staff.nescimento%></td>
          <td><%= staff.estado%></td>
          <td>
            <a class="agendar" data-doc="<%= staff._id%>">Agendar</a>
          </td>
        </tr>
        <% }) %> <% } else { %>
        <tr>
          <td>Não há pessoal a ser mostrar</td>
        </tr>
        <% } %>
      </tbody>
    </table>
    <script>
      const agendar = document.querySelector("a.agendar");
      agendar.addEventListener("click", (e) => {
        const endpoint = `/agendas/staff/${agendar.dataset.doc}`;
        console.log(endpoint)
        window.location.href = endpoint
        /* fetch(endpoint, {
          method: "GET",
        })
          .then((response) => response.json())
          .then((data) => (window.location.href = data.redirect))
          .catch((err) => {
            console.log(err);
          }); */
      });
    </script>
  </body>
</html>
